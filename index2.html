<!DOCTYPE html>
<html>
<head>
    <title>Listado de Películas</title>
    <style>
        /* Estilos del código original */
        /* ... */

        /* Estilos para la cuadrícula de películas */
        .contenedorPeliculas {
            display: flex;
            flex-wrap: wrap;
        }

        .seccion_poster {
            width: 25%;
            padding: 10px;
            box-sizing: border-box;
        }

            .seccion_poster img {
                width: 100%;
                height: auto;
            }

            .seccion_poster h3 {
                margin: 10px 0;
                font-size: 16px;
            }

            .seccion_poster p {
                margin-bottom: 10px;
            }

            .seccion_poster .button {
                display: block;
                padding: 5px 10px;
                background-color: #007bff;
                color: #fff;
                text-decoration: none;
                text-align: center;
            }
    </style>
</head>
<body>
    <header>
        <!-- Contenido original del encabezado -->
        <h1>
            <img src="img/IconoCine.png" alt="icono cine"><span>Cartelera de Cine</span>
        </h1>
        <nav>
            <ul>
                <li class="current-page"><a href="#">Cartelera</a></li>
                <li><a href="favorities.html">Mis Favoritas</a></li>
                <li><a href="help.html">Ayuda</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <h2>Últimas Películas en Cartelera</h2>

        <section id="form-movie-new">
            <!--Seccion para agregar una película favorita por código-->
            <form class="peliculaFavorita">
                Agregar película favorita por Código: <br><br><input type="text" name="nombre-pelicula">
                <button type="submit">Agregar</button>
            </form>
        </section>

        <section id="sec-messages">
            <!--Seccion para mensajes-->
            <!-- ... -->
        </section>

        <section class="seccion_peliculas" id="sec_peliculas">
            <!-- Sección visualización de películas -->
            <div class="contenedorPeliculas" id="contenedorPeliculas">
                <!-- Las películas se agregarán aquí dinámicamente con JavaScript -->
            </div>
        </section>

        <section id="sec_paginador_peliculas">
            <!--Seccion de Paginacion-->
            <div class="paginacion" id="paginacion">
                <button class="btnpaginacion" id="btnAnterior">Anterior</button>
                <button class="btnpaginacion" id="btnSiguiente">Siguiente</button>
            </div>
        </section>

        <section class="seccion-alerta" id="sec-cine-result">
            <!--Sección de mensajes de alerta-->
            <div class="peliculaAgregada">
                <p>Película agregada con éxito</p>
            </div>

            <div class="peliculaExistente">
                <p>La película ingresada ya se encuentra almacenada</p>
            </div>

            <div class="peliculaInexistente">
                <p>Error. La película seleccionada no se encuentra en la API o se produjo un error al consultar</p>
            </div>
        </section>
    </main>

    <footer>
        <p>Desarrollado con ♥ - LC2</p>
    </footer>

    <script>
        const apiKey = '218549589fc1a6b4b567ecf0b05e38f2';
    const moviesPerPage = 4;
    let currentPage = 1;
    let totalPages = 1;

    function displayMovies(page) {
      const contenedorPeliculas = document.getElementById('contenedorPeliculas');
      contenedorPeliculas.innerHTML = ''; // Limpiar el contenido anterior

      fetch(`https://api.themoviedb.org/3/discover/movie?api_key=${apiKey}&sort_by=popularity.desc&page=${page}`) /*el fetch hace una solicitud a la API de moviedb, lo que obtiene una lista de peliculas. El then convierte los datos en formato JSON. El metodo then maneja la respuesta de la solicitud*/
        .then(response => response.json())
        .then(data => {
          const movies = data.results;
          totalPages = data.total_pages;

          movies.forEach(movie => {
            const seccionPoster = document.createElement('div');
            seccionPoster.className = 'seccion_poster';

            const img = document.createElement('img');
            img.className = 'poster';
            img.src = `https://image.tmdb.org/t/p/w500${movie.poster_path}`;
            img.alt = '';

            const title = document.createElement('h3');
            title.textContent = movie.title;

            const details = document.createElement('p');
            details.innerHTML = `Código: ${movie.id}<br>
                                 Título original: ${movie.original_title}<br>
                                 Idioma original: ${movie.original_language}<br>
                                 Año: ${movie.release_date}`;

            const button = document.createElement('a');
            button.className = 'button';
            button.href = 'agregar-a-favoritos';
            button.textContent = 'Agregar a favoritos';

            seccionPoster.appendChild(img);
            seccionPoster.appendChild(title);
            seccionPoster.appendChild(details);
            seccionPoster.appendChild(button);
            contenedorPeliculas.appendChild(seccionPoster);
          });
        })
        .catch(error => {
          console.error('Error:', error);
        });
    }

    function updatePagination() {
      const paginacionElement = document.getElementById('paginacion');
      paginacionElement.innerHTML = '';

      const btnAnterior = document.createElement('button');
      btnAnterior.className = 'btnpaginacion';
      btnAnterior.id = 'btnAnterior';
      btnAnterior.textContent = 'Anterior';
      btnAnterior.addEventListener('click', () => {
        if (currentPage > 1) {
          currentPage--;
          displayMovies(currentPage);
          updatePagination();
        }
      });
      paginacionElement.appendChild(btnAnterior);

      const btnSiguiente = document.createElement('button');
      btnSiguiente.className = 'btnpaginacion';
      btnSiguiente.id = 'btnSiguiente';
      btnSiguiente.textContent = 'Siguiente';
      btnSiguiente.addEventListener('click', () => {
        if (currentPage < totalPages) {
          currentPage++;
          displayMovies(currentPage);
          updatePagination();
        }
      });
      paginacionElement.appendChild(btnSiguiente);
    }

    displayMovies(currentPage);
    updatePagination();
    </script>
</body>
</html>